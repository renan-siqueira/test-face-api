
# Data Association Micro Project

This micro project is part of a larger video presence validation system. It is responsible for associating detected faces in video frames with a reference dataset, which includes labeled images of people. The association process enables the identification of individuals in video frames by comparing detected face encodings with the reference dataset.

## Project Structure

```
data_association/
├── json/
│   └── params.json                 # JSON file with configuration parameters
├── modules/
│   └── data_association_module.py  # Core module for data association functionality
├── settings/
│   └── config.py                   # Configuration file with paths and parameters
├── utils/
│   └── utils.py                    # Utility functions shared across modules
└── main.py                         # Main script that orchestrates the data association process
```

## Functionality

### 1. Load Reference Dataset
The `data_association_module` loads and encodes faces from the reference dataset, where each subfolder represents a person and contains reference images. These encodings are later used to compare against detected faces in the video frames.

### 2. Associate Detected Faces
For each detected face in the video frames, the system:
- Loads the face encodings from JSON files created by the face detection module.
- Compares each detected face encoding with the reference encodings using a similarity threshold.
- Associates detected faces with the closest matching person from the reference dataset, based on the similarity score.

### 3. Generate Association Output
The output includes JSON records for each association, enriched with additional metadata:
- **frame_file**: Name of the video frame file.
- **absolute_image_path**: Path to the frame image.
- **detection_json_path**: Path to the JSON file with face detection results.
- **timestamp**: Date and time of the association.
- **matched_person**: Name of the person matched in the reference dataset.
- **similarity_distance**: Similarity score of the match.
- **detection_method**: Detection method used (e.g., `yolo` or `hog`).
- **processing_details**: Time taken for detection and association.

## Configuration

The project configuration can be set in `config.py` or via a JSON configuration file. The main parameters include:
- **reference_dataset_path**: Path to the folder containing labeled images of people.
- **detection_results_path**: Path to the folder with JSON files containing detected face information.
- **association_output_path**: Output path to save association results.
- **similarity_threshold**: Threshold value for face similarity comparison.

Example `params.json`:

```json
{
  "reference_dataset_path": "/path/to/reference/dataset",
  "detection_results_path": "/path/to/detection/results",
  "association_output_path": "/path/to/association/output",
  "similarity_threshold": 0.6
}
```

## Running the Project

To run the data association module, execute `main.py` with the following command:

```bash
python main.py --json-path /path/to/params.json
```

## Requirements

Ensure you have the following packages installed:
- `face_recognition`
- `tqdm`

Install requirements via pip:

```bash
pip install face_recognition tqdm
```

## Project Notes
- This micro project is designed to work with detection results generated by the face detection micro project.
- The system uses absolute paths for images and JSON files to ensure compatibility across modules.
- Detailed association results are saved in JSON format for easy integration with reporting or further analysis.

## License
This project is licensed under the MIT License.
